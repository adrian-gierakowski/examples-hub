import{C as I,a as b,i as D,b as A,P as W,d as N}from"./CapsuleModal-DdUkouQK.js";import{A as Ce,j as We,E as Pe,K as Ee,e as Te,N as Re,O as Ie,k as Ke,R as Oe,l as Me,S as Ue,w as Le,n as De,t as Ae,p as Ne,m as Ge,y as $e,q as je,u as Fe,z as Ve,x as Be,I as Ye,G as He,J as Je,Q as qe,L as Xe,B as ze,o as Qe,s as Ze,v as xe}from"./CapsuleModal-DdUkouQK.js";import{c9 as T,eC as _,eD as k,as as y,eE as K}from"./index-D-c5h5Hy.js";import{f0 as tt,e$ as nt,eG as it,eQ as st,eF as ot,eH as rt,eM as at,eL as lt,eI as dt,eP as ut,eT as ct,eJ as ft,eS as mt,eO as ht,eR as pt,eK as yt,eN as wt,eW as vt,eV as gt,eZ as St,e_ as bt,eU as kt,eY as _t,eX as Ct}from"./index-D-c5h5Hy.js";var G=function(e,a,r,o){function i(n){return n instanceof r?n:new r(function(s){s(n)})}return new(r||(r=Promise))(function(n,s){function l(u){try{c(o.next(u))}catch(t){s(t)}}function f(u){try{c(o.throw(u))}catch(t){s(t)}}function c(u){u.done?n(u.value):i(u.value).then(l,f)}c((o=o.apply(e,a||[])).next())})};function C(e,a,r){return G(this,void 0,void 0,function*(){const o=Date.now();for(;Date.now()-o<a;){if(yield e())return!0;yield new Promise(i=>setTimeout(i,r))}return!1})}const $=I.version;class j{constructor(){this.get=a=>typeof window<"u"&&localStorage.getItem(a)||null,this.set=(a,r)=>{typeof window<"u"&&localStorage.setItem(a,r)},this.removeItem=a=>{typeof window<"u"&&localStorage.removeItem(a)},this.clear=a=>{if(typeof window<"u")for(let r=0;r<localStorage.length;r++){const o=localStorage.key(r);o&&o.startsWith(a)&&(localStorage.removeItem(o),r--)}}}}class F{constructor(){this.get=a=>typeof window<"u"&&sessionStorage.getItem(a)||null,this.set=(a,r)=>{typeof window<"u"&&sessionStorage.setItem(a,r)},this.removeItem=a=>{typeof window<"u"&&sessionStorage.removeItem(a)},this.clear=a=>{if(typeof window<"u")for(let r=0;r<sessionStorage.length;r++){const o=sessionStorage.key(r);o&&o.startsWith(a)&&(sessionStorage.removeItem(o),r--)}}}}var V=T&&T.__awaiter||function(e,a,r,o){function i(n){return n instanceof r?n:new r(function(s){s(n)})}return new(r||(r=Promise))(function(n,s){function l(u){try{c(o.next(u))}catch(t){s(t)}}function f(u){try{c(o.throw(u))}catch(t){s(t)}}function c(u){u.done?n(u.value):i(u.value).then(l,f)}c((o=o.apply(e,a||[])).next())})};(()=>{const e=()=>{const o=new Error("not implemented");return o.code="ENOSYS",o};if(!globalThis.fs){let o="";globalThis.fs={constants:{O_WRONLY:-1,O_RDWR:-1,O_CREAT:-1,O_TRUNC:-1,O_APPEND:-1,O_EXCL:-1},writeSync(i,n){o+=r.decode(n);const s=o.lastIndexOf(`
`);return s!=-1&&(console.log(o.substring(0,s)),o=o.substring(s+1)),n.length},write(i,n,s,l,f,c){if(s!==0||l!==n.length||f!==null){c(e());return}const u=this.writeSync(i,n);c(null,u)},chmod(i,n,s){s(e())},chown(i,n,s,l){l(e())},close(i,n){n(e())},fchmod(i,n,s){s(e())},fchown(i,n,s,l){l(e())},fstat(i,n){n(e())},fsync(i,n){n(null)},ftruncate(i,n,s){s(e())},lchown(i,n,s,l){l(e())},link(i,n,s){s(e())},lstat(i,n){n(e())},mkdir(i,n,s){s(e())},open(i,n,s,l){l(e())},read(i,n,s,l,f,c){c(e())},readdir(i,n){n(e())},readlink(i,n){n(e())},rename(i,n,s){s(e())},rmdir(i,n){n(e())},stat(i,n){n(e())},symlink(i,n,s){s(e())},truncate(i,n,s){s(e())},unlink(i,n){n(e())},utimes(i,n,s,l){l(e())}}}if(globalThis.process||(globalThis.process={getuid(){return-1},getgid(){return-1},geteuid(){return-1},getegid(){return-1},getgroups(){throw e()},pid:-1,ppid:-1,umask(){throw e()},cwd(){throw e()},chdir(){throw e()}}),!globalThis.crypto)throw new Error("globalThis.crypto is not available, polyfill required (crypto.getRandomValues only)");if(globalThis.performance||(globalThis.performance=Date),!globalThis.TextEncoder)throw new Error("globalThis.TextEncoder is not available, polyfill required");if(!globalThis.TextDecoder)throw new Error("globalThis.TextDecoder is not available, polyfill required");const a=new TextEncoder("utf-8"),r=new TextDecoder("utf-8");globalThis.Go=class{constructor(){this.argv=["js"],this.env={},this.exit=t=>{t!==0&&console.warn("exit code:",t)},this._exitPromise=new Promise(t=>{this._resolveExitPromise=t}),this._pendingEvent=null,this._scheduledTimeouts=new Map,this._nextCallbackTimeoutID=1;const o=(t,d)=>{this.mem.setUint32(t+0,d,!0),this.mem.setUint32(t+4,Math.floor(d/4294967296),!0)},i=t=>{const d=this.mem.getUint32(t+0,!0),m=this.mem.getInt32(t+4,!0);return d+m*4294967296},n=t=>{const d=this.mem.getFloat64(t,!0);if(d===0)return;if(!isNaN(d))return d;const m=this.mem.getUint32(t,!0);return this._values[m]},s=(t,d)=>{if(typeof d=="number"&&d!==0){if(isNaN(d)){this.mem.setUint32(t+4,2146959360,!0),this.mem.setUint32(t,0,!0);return}this.mem.setFloat64(t,d,!0);return}if(d===void 0){this.mem.setFloat64(t,0,!0);return}let h=this._ids.get(d);h===void 0&&(h=this._idPool.pop(),h===void 0&&(h=this._values.length),this._values[h]=d,this._goRefCounts[h]=0,this._ids.set(d,h)),this._goRefCounts[h]++;let v=0;switch(typeof d){case"object":d!==null&&(v=1);break;case"string":v=2;break;case"symbol":v=3;break;case"function":v=4;break}this.mem.setUint32(t+4,2146959360|v,!0),this.mem.setUint32(t,h,!0)},l=t=>{const d=i(t+0),m=i(t+8);return new Uint8Array(this._inst.exports.mem.buffer,d,m)},f=t=>{const d=i(t+0),m=i(t+8),h=new Array(m);for(let v=0;v<m;v++)h[v]=n(d+v*8);return h},c=t=>{const d=i(t+0),m=i(t+8);return r.decode(new DataView(this._inst.exports.mem.buffer,d,m))},u=Date.now()-performance.now();this.importObject={_gotest:{add:(t,d)=>t+d},gojs:{"runtime.wasmExit":t=>{t>>>=0;const d=this.mem.getInt32(t+8,!0);this.exited=!0,delete this._inst,delete this._values,delete this._goRefCounts,delete this._ids,delete this._idPool,this.exit(d)},"runtime.wasmWrite":t=>{t>>>=0;const d=i(t+8),m=i(t+16),h=this.mem.getInt32(t+24,!0);fs.writeSync(d,new Uint8Array(this._inst.exports.mem.buffer,m,h))},"runtime.resetMemoryDataView":t=>{this.mem=new DataView(this._inst.exports.mem.buffer)},"runtime.nanotime1":t=>{t>>>=0,o(t+8,(u+performance.now())*1e6)},"runtime.walltime":t=>{t>>>=0;const d=new Date().getTime();o(t+8,d/1e3),this.mem.setInt32(t+16,d%1e3*1e6,!0)},"runtime.scheduleTimeoutEvent":t=>{t>>>=0;const d=this._nextCallbackTimeoutID;this._nextCallbackTimeoutID++,this._scheduledTimeouts.set(d,setTimeout(()=>{for(this._resume();this._scheduledTimeouts.has(d);)console.warn("scheduleTimeoutEvent: missed timeout event"),this._resume()},i(t+8))),this.mem.setInt32(t+16,d,!0)},"runtime.clearTimeoutEvent":t=>{t>>>=0;const d=this.mem.getInt32(t+8,!0);clearTimeout(this._scheduledTimeouts.get(d)),this._scheduledTimeouts.delete(d)},"runtime.getRandomData":t=>{t>>>=0,crypto.getRandomValues(l(t+8))},"syscall/js.finalizeRef":t=>{t>>>=0;const d=this.mem.getUint32(t+8,!0);if(this._goRefCounts[d]--,this._goRefCounts[d]===0){const m=this._values[d];this._values[d]=null,this._ids.delete(m),this._idPool.push(d)}},"syscall/js.stringVal":t=>{t>>>=0,s(t+24,c(t+8))},"syscall/js.valueGet":t=>{t>>>=0;const d=Reflect.get(n(t+8),c(t+16));t=this._inst.exports.getsp()>>>0,s(t+32,d)},"syscall/js.valueSet":t=>{t>>>=0,Reflect.set(n(t+8),c(t+16),n(t+32))},"syscall/js.valueDelete":t=>{t>>>=0,Reflect.deleteProperty(n(t+8),c(t+16))},"syscall/js.valueIndex":t=>{t>>>=0,s(t+24,Reflect.get(n(t+8),i(t+16)))},"syscall/js.valueSetIndex":t=>{t>>>=0,Reflect.set(n(t+8),i(t+16),n(t+24))},"syscall/js.valueCall":t=>{t>>>=0;try{const d=n(t+8),m=Reflect.get(d,c(t+16)),h=f(t+32),v=Reflect.apply(m,d,h);t=this._inst.exports.getsp()>>>0,s(t+56,v),this.mem.setUint8(t+64,1)}catch(d){t=this._inst.exports.getsp()>>>0,s(t+56,d),this.mem.setUint8(t+64,0)}},"syscall/js.valueInvoke":t=>{t>>>=0;try{const d=n(t+8),m=f(t+16),h=Reflect.apply(d,void 0,m);t=this._inst.exports.getsp()>>>0,s(t+40,h),this.mem.setUint8(t+48,1)}catch(d){t=this._inst.exports.getsp()>>>0,s(t+40,d),this.mem.setUint8(t+48,0)}},"syscall/js.valueNew":t=>{t>>>=0;try{const d=n(t+8),m=f(t+16),h=Reflect.construct(d,m);t=this._inst.exports.getsp()>>>0,s(t+40,h),this.mem.setUint8(t+48,1)}catch(d){t=this._inst.exports.getsp()>>>0,s(t+40,d),this.mem.setUint8(t+48,0)}},"syscall/js.valueLength":t=>{t>>>=0,o(t+16,parseInt(n(t+8).length))},"syscall/js.valuePrepareString":t=>{t>>>=0;const d=a.encode(String(n(t+8)));s(t+16,d),o(t+24,d.length)},"syscall/js.valueLoadString":t=>{t>>>=0;const d=n(t+8);l(t+16).set(d)},"syscall/js.valueInstanceOf":t=>{t>>>=0,this.mem.setUint8(t+24,n(t+8)instanceof n(t+16)?1:0)},"syscall/js.copyBytesToGo":t=>{t>>>=0;const d=l(t+8),m=n(t+32);if(!(m instanceof Uint8Array||m instanceof Uint8ClampedArray)){this.mem.setUint8(t+48,0);return}const h=m.subarray(0,d.length);d.set(h),o(t+40,h.length),this.mem.setUint8(t+48,1)},"syscall/js.copyBytesToJS":t=>{t>>>=0;const d=n(t+8),m=l(t+16);if(!(d instanceof Uint8Array||d instanceof Uint8ClampedArray)){this.mem.setUint8(t+48,0);return}const h=m.subarray(0,d.length);d.set(h),o(t+40,h.length),this.mem.setUint8(t+48,1)},debug:t=>{console.log(t)}}}}run(o){return V(this,void 0,void 0,function*(){if(!(o instanceof WebAssembly.Instance))throw new Error("Go.run: WebAssembly.Instance expected");this._inst=o,this.mem=new DataView(this._inst.exports.mem.buffer),this._values=[NaN,0,null,!0,!1,globalThis,this],this._goRefCounts=new Array(this._values.length).fill(1/0),this._ids=new Map([[0,1],[null,2],[!0,3],[!1,4],[globalThis,5],[this,6]]),this._idPool=[],this.exited=!1;let i=4096;const n=t=>{const d=i,m=a.encode(t+"\0");return new Uint8Array(this.mem.buffer,i,m.length).set(m),i+=m.length,i%8!==0&&(i+=8-i%8),d},s=this.argv.length,l=[];this.argv.forEach(t=>{l.push(n(t))}),l.push(0),Object.keys(this.env).sort().forEach(t=>{l.push(n(`${t}=${this.env[t]}`))}),l.push(0);const c=i;if(l.forEach(t=>{this.mem.setUint32(i,t,!0),this.mem.setUint32(i+4,0,!0),i+=8}),i>=12288)throw new Error("total length of command line and environment variables exceeds limit");this._inst.exports.run(s,c),this.exited&&this._resolveExitPromise(),yield this._exitPromise})}_resume(){if(this.exited)throw new Error("Go program has already exited");this._inst.exports.resume(),this.exited&&this._resolveExitPromise()}_makeFuncWrapper(o){const i=this;return function(){const n={id:o,this:this,args:arguments};return i._pendingEvent=n,i._resume(),n.result}}}})();var w=function(e,a,r,o){function i(n){return n instanceof r?n:new r(function(s){s(n)})}return new(r||(r=Promise))(function(n,s){function l(u){try{c(o.next(u))}catch(t){s(t)}}function f(u){try{c(o.throw(u))}catch(t){s(t)}}function c(u){u.done?n(u.value):i(u.value).then(l,f)}c((o=o.apply(e,a||[])).next())})};const B=(e,a,r)=>`{"ServerUrl":"${e}", "WalletId": "${a}", "Id":"${r}", "Ids":["USER","CAPSULE"], "Threshold":1}`,O=(e,a,r)=>`{"walletId": "${e}", "id":"${a}", "otherId":"CAPSULE", "isReceiver": false, "disableWebSockets": ${r}}`;function Y(e,a,r,o){return w(this,void 0,void 0,function*(){const{data:i}=yield e.mpcComputationClient.post("/wallets",{userId:a,walletId:r,protocolId:o});return i})}function H(e,a,r,o,i,n){return w(this,void 0,void 0,function*(){const{data:s}=yield e.mpcComputationClient.post(`/wallets/${r}/messages/sign`,{userId:a,protocolId:o,message:i,signer:n});return s})}function M(e,a,r,o,i,n,s){return w(this,void 0,void 0,function*(){const{data:l}=yield e.mpcComputationClient.post(`/wallets/${r}/transactions/send`,{userId:a,protocolId:o,transaction:i,signer:n,chainId:s});return l})}function J(e,a){return w(this,void 0,void 0,function*(){const{walletId:r,protocolId:o}=yield e.capsuleClient.createWallet(a,{scheme:_.ED25519,type:k.SOLANA}),i=b(e.env,!e.disableWebSockets);return{signer:yield new Promise((s,l)=>y.ed25519CreateAccount(i,r,o,(f,c)=>{f&&l(f),s(c)})),walletId:r}})}function q(e,a,r){return w(this,void 0,void 0,function*(){const{walletId:o,protocolId:i}=yield e.capsuleClient.createWalletPreGen({pregenIdentifier:a,pregenIdentifierType:r,scheme:_.ED25519,type:k.SOLANA}),n=b(e.env,!e.disableWebSockets);return{signer:yield new Promise((l,f)=>y.ed25519CreateAccount(n,o,i,(c,u)=>{c&&f(c),l(u)})),walletId:o}})}function X(e,a,r,o,i){return w(this,void 0,void 0,function*(){const{protocolId:n}=yield e.capsuleClient.preSignMessage(r,o,i,_.ED25519);return{signature:yield new Promise((l,f)=>y.ed25519Sign(a,n,i,(c,u)=>{c&&f(c),l(u)}))}})}function z(e,a,r,o){return w(this,void 0,void 0,function*(){const{walletId:i,protocolId:n}=yield e.capsuleClient.createWallet(a,{useTwoSigners:!0,scheme:e.useDKLS?_.DKLS:_.CGGMP,type:r,cosmosPrefix:r===k.COSMOS?e.cosmosPrefix:void 0});if(e.offloadMPCComputationURL&&!e.useDKLS)return{signer:(yield Y(e,a,i,n)).signer,walletId:i};const s=b(e.env,!e.disableWebSockets),l=e.useDKLS?O(i,"USER",e.disableWebSockets):B(s,i,"USER"),f=e.useDKLS?y.dklsCreateAccount:y.createAccountV2;return{signer:yield new Promise((u,t)=>f(l,s,n,o,()=>{},(d,m)=>{d&&t(d),u(m)})),walletId:i}})}function Q(e,a,r,o,i,n){return w(this,void 0,void 0,function*(){const{walletId:s,protocolId:l}=yield e.capsuleClient.createWalletPreGen({pregenIdentifier:r,pregenIdentifierType:o,type:i,cosmosPrefix:i===k.COSMOS?e.cosmosPrefix:void 0}),f=b(e.env,!e.disableWebSockets),c=O(s,"USER",e.disableWebSockets);return{signer:yield new Promise((t,d)=>y.dklsCreateAccount(c,f,l,n,()=>{},(m,h)=>{m&&d(m),t(h)})),walletId:s}})}function Z(e,a,r,o,i){return w(this,void 0,void 0,function*(){const{protocolId:n,pendingTransactionId:s}=yield e.capsuleClient.preSignMessage(o,r,i);if(s)return console.error("sign message denied"),{pendingTransactionId:s};if(e.offloadMPCComputationURL&&!e.useDKLS)return H(e,o,r,n,i,a);const l=b(e.env,!e.disableWebSockets),f=e.useDKLS?y.dklsSignMessage:y.signMessage,c=JSON.parse(a);return!c.disableWebSockets!=!e.disableWebSockets&&(c.disableWebSockets=e.disableWebSockets),a=JSON.stringify(c),new Promise((u,t)=>f(a,l,i,n,(d,m)=>{d&&t(d),u({signature:m})}))})}function x(e,a,r,o,i,n){return w(this,void 0,void 0,function*(){const{data:{protocolId:s,pendingTransactionId:l}}=yield e.capsuleClient.signTransaction(o,r,{transaction:i,chainId:n});if(l)return console.error("send transaction denied"),{pendingTransactionId:l};if(e.offloadMPCComputationURL&&!e.useDKLS)return M(e,o,r,s,i,a,n);const f=b(e.env,!e.disableWebSockets),c=e.useDKLS?y.dklsSendTransaction:y.sendTransaction,u=JSON.parse(a);return!u.disableWebSockets!=!e.disableWebSockets&&(u.disableWebSockets=e.disableWebSockets),a=JSON.stringify(u),new Promise((t,d)=>c(a,f,i,n,s,(m,h)=>{m&&d(m),t({signature:h})}))})}function ee(e,a,r,o,i,n){return w(this,void 0,void 0,function*(){const{data:{protocolId:s,pendingTransactionId:l}}=yield e.capsuleClient.sendTransaction(o,r,{transaction:i,chainId:n});if(l)return console.error("send transaction denied"),{pendingTransactionId:l};if(e.offloadMPCComputationURL&&!e.useDKLS)return M(e,o,r,s,i,a,n);const f=b(e.env,!e.disableWebSockets),c=e.useDKLS?y.dklsSendTransaction:y.sendTransaction,u=JSON.parse(a);return!u.disableWebSockets!=!e.disableWebSockets&&(u.disableWebSockets=e.disableWebSockets),a=JSON.stringify(u),new Promise((t,d)=>c(a,f,i,n,s,(m,h)=>{m&&d(m),t({signature:h})}))})}function te(e,a,r,o,i,n){return w(this,void 0,void 0,function*(){const{data:{protocolId:s}}=yield e.capsuleClient.refreshKeys(o,r,i,n),l=b(e.env,!e.disableWebSockets),f=e.useDKLS?y.dklsRefresh:y.refresh,c=JSON.parse(a);return!c.disableWebSockets!=!e.disableWebSockets&&(c.disableWebSockets=e.disableWebSockets),a=JSON.stringify(c),new Promise((u,t)=>f(a,l,s,(d,m)=>{d&&t(d),u(m)}))})}function ne(e,a,r,o){return w(this,void 0,void 0,function*(){const i=yield e.capsuleClient.getCapsuleShare(o,r);return i?new Promise((n,s)=>y.getPrivateKey(a,i,(l,f)=>{l&&s(l),n(f)})):""})}var ie={},E=function(e,a,r,o){function i(n){return n instanceof r?n:new r(function(s){s(n)})}return new(r||(r=Promise))(function(n,s){function l(u){try{c(o.next(u))}catch(t){s(t)}}function f(u){try{c(o.throw(u))}catch(t){s(t)}}function c(u){u.done?n(u.value):i(u.value).then(l,f)}c((o=o.apply(e,[])).next())})};function se(e,a){return E(this,void 0,void 0,function*(){const r=new self.Go;let o=a;if(!o){if(ie.DISABLE_WASM_FETCH==="true")throw new Error("fetching wasm file is disabled");o=yield(yield fetch(`${K(e)}/static/js/main.wasm`,{mode:"cors"})).arrayBuffer()}const i=yield WebAssembly.instantiate(o,r.importObject);r.run(i.instance)})}function oe(e,a){return E(this,void 0,void 0,function*(){const{functionType:r,params:o}=a;switch(r){case"KEYGEN":{const{userId:i,secretKey:n,type:s=k.EVM}=o;return yield z(e,i,s,n)}case"SIGN_TRANSACTION":{const{share:i,walletId:n,userId:s,tx:l,chainId:f}=o;return x(e,i,n,s,l,f)}case"SEND_TRANSACTION":{const{share:i,walletId:n,userId:s,tx:l,chainId:f}=o;return ee(e,i,n,s,l,f)}case"SIGN_MESSAGE":{const{share:i,walletId:n,userId:s,message:l}=o;return Z(e,i,n,s,l)}case"REFRESH":{const{share:i,walletId:n,userId:s,oldPartnerId:l,newPartnerId:f}=o;return te(e,i,n,s,l,f)}case"PREKEYGEN":{const{email:i,partnerId:n,secretKey:s,type:l=k.EVM}=o;let{pregenIdentifier:f,pregenIdentifierType:c}=o;return i!=="null"&&i!=="undefined"&&i!==""&&i!=null&&(f=i,c=W.EMAIL),yield Q(e,n,f,c,l,s)}case"GET_PRIVATE_KEY":{const{share:i,walletId:n,userId:s}=o;return yield ne(e,i,n,s)}case"ED25519_KEYGEN":{const{userId:i}=o;return J(e,i)}case"ED25519_SIGN":{const{share:i,walletId:n,userId:s,base64Bytes:l}=o;return X(e,i,s,n,l)}case"ED25519_PREKEYGEN":{const{email:i}=o;let{pregenIdentifier:n,pregenIdentifierType:s}=o;return i!=="null"&&i!=="undefined"&&i!==""&&i!=null&&(n=i,s=W.EMAIL),q(e,n,s)}default:throw new Error(`functionType: ${r} not supported`)}})}function re(e,a,r){return E(this,void 0,void 0,function*(){const{env:o,apiKey:i,cosmosPrefix:n="cosmos",offloadMPCComputationURL:s,disableWorkers:l,sessionCookie:f,useDKLS:c,disableWebSockets:u,wasmOverride:t}=e.data;if(!o)return!0;const d={env:o,apiKey:i,cosmosPrefix:n,capsuleClient:D(o,$,i,r,()=>f),offloadMPCComputationURL:s,mpcComputationClient:s?A(s,!!l):void 0,useDKLS:c,disableWebSockets:!!u,wasmOverride:t};(!d.offloadMPCComputationURL||d.useDKLS)&&(yield se(d,t));const m=yield oe(d,e.data);return a(m),!1})}var R=function(e,a,r,o){function i(n){return n instanceof r?n:new r(function(s){s(n)})}return new(r||(r=Promise))(function(n,s){function l(u){try{c(o.next(u))}catch(t){s(t)}}function f(u){try{c(o.throw(u))}catch(t){s(t)}}function c(u){u.done?n(u.value):i(u.value).then(l,f)}c((o=o.apply(e,a||[])).next())})};function S(e,a){return R(this,void 0,void 0,function*(){const r=i=>{i.data.functionType!=="CUSTOM"&&a(i.data)};if(e.disableWorkers)return{postMessage:function(n){(function(){return R(this,void 0,void 0,function*(){yield re({data:n},s=>r({data:s}),e.disableWorkers)})})()},terminate:()=>{}};let o;if(e.useLocalFiles)throw new Error("useLocalFiles only supported locally");{const i=yield fetch(`${K(e)}/static/js/mpcWorker-bundle.js`),n=new Blob([yield i.text()],{type:"application/javascript"}),s=URL.createObjectURL(n);o=new Worker(s)}return o.onmessage=r,o})}var p=function(e,a,r,o){function i(n){return n instanceof r?n:new r(function(s){s(n)})}return new(r||(r=Promise))(function(n,s){function l(u){try{c(o.next(u))}catch(t){s(t)}}function f(u){try{c(o.throw(u))}catch(t){s(t)}}function c(u){u.done?n(u.value):i(u.value).then(l,f)}c((o=o.apply(e,a||[])).next())})};function U(e,a,r){return p(this,void 0,void 0,function*(){return!!(yield e.capsuleClient.getWallets(a)).data.wallets.find(n=>n.id===r).address})}function ae(e,a,r,o){return p(this,void 0,void 0,function*(){const{isDone:i}=yield e.capsuleClient.isRefreshDone(a,r,o);return i})}function L(e,a,r,o){return p(this,void 0,void 0,function*(){return!!(yield e.capsuleClient.getPregenWallets(a,r)).wallets.find(s=>s.id===o).address})}function le(e,a,r,o,i=!1,n,s={}){return new Promise(l=>p(this,void 0,void 0,function*(){const f=yield S(e,c=>p(this,void 0,void 0,function*(){if(yield C(()=>p(this,void 0,void 0,function*(){return U(e,a,c.walletId)}),15e3,1e3),i){l({signer:c.signer,walletId:c.walletId,recoveryShare:null}),f.terminate();return}const u=yield N(e,a,c.walletId,c.signer,!1,s);l({signer:c.signer,walletId:c.walletId,recoveryShare:u}),f.terminate()}));f.postMessage({env:e.env,apiKey:e.apiKey,cosmosPrefix:e.cosmosPrefix,params:{userId:a,secretKey:o,type:r},functionType:"KEYGEN",offloadMPCComputationURL:e.offloadMPCComputationURL,disableWorkers:e.disableWorkers,sessionCookie:n,useDKLS:e.useDKLS,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))}function de(e,a,r,o,i,n=!1,s,l){return new Promise(f=>p(this,void 0,void 0,function*(){const c=yield S(e,d=>p(this,void 0,void 0,function*(){yield C(()=>p(this,void 0,void 0,function*(){return L(e,a,r,d.walletId)}),15e3,1e3),f({signer:d.signer,walletId:d.walletId,recoveryShare:null}),c.terminate()})),t={pregenIdentifier:a,pregenIdentifierType:r,type:o,secretKey:i,partnerId:s,email:void 0};r===W.EMAIL&&(t.email=a),c.postMessage({env:e.env,apiKey:e.apiKey,cosmosPrefix:e.cosmosPrefix,params:t,functionType:"PREKEYGEN",offloadMPCComputationURL:e.offloadMPCComputationURL,disableWorkers:e.disableWorkers,sessionCookie:l,useDKLS:e.useDKLS,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))}function ue(e,a,r,o,i,n,s){return new Promise(l=>p(this,void 0,void 0,function*(){const f=yield S(e,c=>p(this,void 0,void 0,function*(){yield C(()=>p(this,void 0,void 0,function*(){return ae(e,r,o,s)}),15e3,1e3),l({signer:c}),f.terminate()}));f.postMessage({env:e.env,apiKey:e.apiKey,params:{userId:r,walletId:o,share:i,oldPartnerId:n,newPartnerId:s},functionType:"REFRESH",disableWorkers:e.disableWorkers,sessionCookie:a,useDKLS:e.useDKLS,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))}function ce(e,a,r,o={}){return new Promise(i=>p(this,void 0,void 0,function*(){const n=yield S(e,s=>p(this,void 0,void 0,function*(){yield C(()=>p(this,void 0,void 0,function*(){return U(e,a,s.walletId)}),15e3,1e3),i({signer:s.signer,walletId:s.walletId,recoveryShare:null}),n.terminate()}));n.postMessage({env:e.env,apiKey:e.apiKey,cosmosPrefix:e.cosmosPrefix,params:{userId:a},functionType:"ED25519_KEYGEN",disableWorkers:e.disableWorkers,sessionCookie:r,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))}function fe(e,a,r,o){return new Promise(i=>p(this,void 0,void 0,function*(){const n=yield S(e,f=>p(this,void 0,void 0,function*(){yield C(()=>p(this,void 0,void 0,function*(){return L(e,a,r,f.walletId)}),15e3,1e3),i({signer:f.signer,walletId:f.walletId,recoveryShare:null}),n.terminate()})),l={pregenIdentifier:a,pregenIdentifierType:r,email:void 0};r===W.EMAIL&&(l.email=a),n.postMessage({env:e.env,apiKey:e.apiKey,cosmosPrefix:e.cosmosPrefix,params:l,functionType:"ED25519_PREKEYGEN",disableWorkers:e.disableWorkers,sessionCookie:o,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))}var g=function(e,a,r,o){function i(n){return n instanceof r?n:new r(function(s){s(n)})}return new(r||(r=Promise))(function(n,s){function l(u){try{c(o.next(u))}catch(t){s(t)}}function f(u){try{c(o.throw(u))}catch(t){s(t)}}function c(u){u.done?n(u.value):i(u.value).then(l,f)}c((o=o.apply(e,a||[])).next())})};function me(e,a,r,o,i,n,s,l){return g(this,void 0,void 0,function*(){return yield new Promise(f=>g(this,void 0,void 0,function*(){const c=yield S(e,u=>g(this,void 0,void 0,function*(){f(u),c.terminate()}));c.postMessage({env:e.env,apiKey:e.apiKey,cosmosPrefix:e.cosmosPrefix,params:{share:o,walletId:r,userId:a,tx:i,chainId:n},functionType:"SIGN_TRANSACTION",offloadMPCComputationURL:e.offloadMPCComputationURL,disableWorkers:e.disableWorkers,sessionCookie:s,useDKLS:l,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))})}function he(e,a,r,o,i,n,s,l){return g(this,void 0,void 0,function*(){return yield new Promise(f=>g(this,void 0,void 0,function*(){const c=yield S(e,u=>g(this,void 0,void 0,function*(){f(u),c.terminate()}));c.postMessage({env:e.env,apiKey:e.apiKey,cosmosPrefix:e.cosmosPrefix,params:{share:o,walletId:r,userId:a,tx:i,chainId:n},functionType:"SEND_TRANSACTION",offloadMPCComputationURL:e.offloadMPCComputationURL,disableWorkers:e.disableWorkers,sessionCookie:s,useDKLS:l,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))})}function pe(e,a,r,o,i,n,s){return g(this,void 0,void 0,function*(){return yield new Promise(l=>g(this,void 0,void 0,function*(){const f=yield S(e,c=>g(this,void 0,void 0,function*(){l(c),f.terminate()}));f.postMessage({env:e.env,apiKey:e.apiKey,cosmosPrefix:e.cosmosPrefix,params:{share:o,walletId:r,userId:a,message:i},functionType:"SIGN_MESSAGE",offloadMPCComputationURL:e.offloadMPCComputationURL,disableWorkers:e.disableWorkers,sessionCookie:n,useDKLS:s,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))})}function ye(e,a,r,o,i,n){return g(this,void 0,void 0,function*(){return yield new Promise(s=>g(this,void 0,void 0,function*(){const l=yield S(e,f=>g(this,void 0,void 0,function*(){s(f),l.terminate()}));l.postMessage({env:e.env,apiKey:e.apiKey,cosmosPrefix:e.cosmosPrefix,params:{share:o,walletId:r,userId:a,base64Bytes:i},functionType:"ED25519_SIGN",disableWorkers:e.disableWorkers,sessionCookie:n,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))})}var P=function(e,a,r,o){function i(n){return n instanceof r?n:new r(function(s){s(n)})}return new(r||(r=Promise))(function(n,s){function l(u){try{c(o.next(u))}catch(t){s(t)}}function f(u){try{c(o.throw(u))}catch(t){s(t)}}function c(u){u.done?n(u.value):i(u.value).then(l,f)}c((o=o.apply(e,a||[])).next())})};function we(e,a,r,o,i){return P(this,void 0,void 0,function*(){return yield new Promise(n=>P(this,void 0,void 0,function*(){const s=yield S(e,l=>P(this,void 0,void 0,function*(){n(l),s.terminate()}));s.postMessage({env:e.env,apiKey:e.apiKey,cosmosPrefix:e.cosmosPrefix,params:{share:o,walletId:r,userId:a},functionType:"GET_PRIVATE_KEY",offloadMPCComputationURL:e.offloadMPCComputationURL,disableWorkers:e.disableWorkers,sessionCookie:i,useDKLS:e.useDKLS,disableWebSockets:e.disableWebSockets,wasmOverride:e.wasmOverride})}))})}class ve{constructor(){this.localStorage=new j,this.sessionStorage=new F,this.secureStorage=null,this.isSyncStorage=!0,this.disableProviderModal=!1}getPrivateKey(a,r,o,i,n){return we(a,r,o,i,n)}keygen(a,r,o,i,n,s={}){return le(a,r,o,i,!0,n,s)}refresh(a,r,o,i,n,s,l){return ue(a,r,o,i,n,s,l)}preKeygen(a,r,o,i,n,s,l){return de(a,o,i,n,s,!1,r,l)}signMessage(a,r,o,i,n,s,l){return pe(a,r,o,i,n,s,l)}signTransaction(a,r,o,i,n,s,l,f){return me(a,r,o,i,n,s,l,f)}sendTransaction(a,r,o,i,n,s,l,f){return he(a,r,o,i,n,s,l,f)}signHash(a,r){throw new Error("not implemented")}ed25519Keygen(a,r,o,i){return ce(a,r,o,i)}ed25519PreKeygen(a,r,o,i){return fe(a,r,o,i)}ed25519Sign(a,r,o,i,n,s){return ye(a,r,o,i,n,s)}openPopup(a){window.open(a,"popup","popup=true,width=400,height=500")||setTimeout(()=>{window.open(a,"_blank")},0)}}class be extends I{getPlatformUtils(){return new ve}}export{Ce as AuthLayout,tt as CURRENT_WALLET_IDS_CHANGE_EVENT,We as CapsuleModal,be as CapsuleWeb,I as CoreCapsule,nt as EXTERNAL_WALLET_CHANGE_EVENT,it as EmailTheme,st as EnabledFlow,ot as Environment,Pe as ExternalWalletType,Ee as KeyContainer,Te as ModalStep,Re as NETWORKS,rt as Network,at as NetworkMap,lt as OAuthMethod,Ie as ON_RAMP_PROVIDERS,dt as OnRampAsset,ut as OnRampAssetMap,Ke as OnRampConfigError,ct as OnRampMethod,ft as OnRampProvider,mt as OnRampProviderAssetMap,ht as OnRampProviderMap,pt as OnRampProviderNetworkMap,yt as OnRampPurchaseStatus,W as PregenIdentifierType,Oe as RecoveryStatus,Me as STORAGE_PREFIX,Ue as SaveRecoverySecret,wt as SupportedOnRamps,_ as WalletScheme,vt as WalletSchemeMap,k as WalletType,$ as capsuleVersion,Le as decimalToHex,De as decryptWithPrivateKey,be as default,N as distributeNewShare,Ae as encryptWithDerivedPublicKey,gt as getAsset,Ne as getAsymmetricKeyPair,b as getBaseMPCNetworkUrl,Ge as getBaseUrl,$e as getCosmosAddress,St as getNetwork,K as getPortalBaseURL,bt as getPortalDomain,kt as getProvider,_t as getProviderAssetInverse,Ct as getProviderNetworkAndAssetCode,je as getPublicKeyHex,Fe as hexToDecimal,D as initClient,Ve as isAndroid,Be as isCosmosWithPrefix,Ye as isIOS,He as isLargeIOS,Je as isMobile,qe as isMobileSafari,Xe as isSafari,ze as isSmallIOS,Qe as openPopup,Ze as stringToPhoneNumber,xe as validateOnRampConfig,C as waitUntilTrue};
